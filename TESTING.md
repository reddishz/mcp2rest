# MCP2REST æµ‹è¯•æŒ‡å—

æœ¬æ–‡æ¡£ä»‹ç»å¦‚ä½•æµ‹è¯• MCP2REST åç«¯çš„ REST åŠŸèƒ½æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚

## æµ‹è¯•ç¨‹åºæ¦‚è¿°

æˆ‘ä»¬æä¾›äº†ä¸‰ç§æµ‹è¯•æ–¹å¼ï¼š

1. **Go æµ‹è¯•å®¢æˆ·ç«¯** (`cmd/test_client/main.go`) - å®Œæ•´çš„æµ‹è¯•å¥—ä»¶
2. **Shell æµ‹è¯•è„šæœ¬** (`scripts/test_mcp.sh`) - åŠŸèƒ½æµ‹è¯•è„šæœ¬
3. **ç®€å•æµ‹è¯•è„šæœ¬** (`scripts/simple_test.sh`) - å¿«é€ŸéªŒè¯è„šæœ¬

## å‰ç½®æ¡ä»¶

1. ç¡®ä¿é¡¹ç›®å·²ç¼–è¯‘ï¼š
   ```bash
   go build -o bin/mcp2rest cmd/mcp2rest/main.go
   ```

2. ç¡®ä¿é…ç½®æ–‡ä»¶å­˜åœ¨ï¼š
   ```bash
   ls configs/bmc_api.yaml
   ```

3. ç¡®ä¿æœåŠ¡å™¨é…ç½®ä¸º stdio æ¨¡å¼ï¼š
   ```yaml
   # configs/server.yaml
   server:
     mode: "stdio"  # å¿…é¡»è®¾ç½®ä¸º stdio æ¨¡å¼
   ```

## æµ‹è¯•æ–¹æ³•

### 1. ä½¿ç”¨ Go æµ‹è¯•å®¢æˆ·ç«¯ï¼ˆæ¨èï¼‰

è¿™æ˜¯æœ€å®Œæ•´çš„æµ‹è¯•æ–¹å¼ï¼Œæä¾›äº†è¯¦ç»†çš„æµ‹è¯•æŠ¥å‘Šå’Œé”™è¯¯ä¿¡æ¯ã€‚

```bash
# ç¼–è¯‘æµ‹è¯•å®¢æˆ·ç«¯
go build -o bin/test_client cmd/test_client/main.go

# è¿è¡Œæµ‹è¯•
./bin/test_client
```

**æµ‹è¯•å†…å®¹ï¼š**
- BMC åˆ—è¡¨æŸ¥è¯¢ (`list`)
- BMC è¯¦æƒ…æŸ¥è¯¢ (`detail`)
- BMC æœç´¢ (`search`)
- BMC åˆ›å»º (`create`)
- BMC æ›´æ–° (`update`)
- BMC åˆ é™¤ (`delete`)

**è¾“å‡ºç¤ºä¾‹ï¼š**
```
ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨...
å¼€å§‹è¿è¡Œ 6 ä¸ªæµ‹è¯•ç”¨ä¾‹...
============================================================
æµ‹è¯• 1/6: æµ‹è¯• BMC åˆ—è¡¨æŸ¥è¯¢
æè¿°: æµ‹è¯•è·å– BMC æ•°æ®åˆ—è¡¨åŠŸèƒ½
å·¥å…·: list
å‚æ•°: map[limit:10 order:desc page:1 sort:created]
âœ… æˆåŠŸ (è€—æ—¶: 1.234s)
å“åº”: map[result:map[data:map[list:[] pagination:map[limit:10 page:1 total:0]] message:success]]
----------------------------------------
...
============================================================
æµ‹è¯•æ€»ç»“
============================================================
æ€»æµ‹è¯•æ•°: 6
æˆåŠŸæ•°: 6
å¤±è´¥æ•°: 0
æˆåŠŸç‡: 100.00%
æ€»è€—æ—¶: 7.234s
å¹³å‡è€—æ—¶: 1.206s

ğŸ‰ æ‰€æœ‰æµ‹è¯•éƒ½é€šè¿‡äº†ï¼
```

### 2. ä½¿ç”¨ Shell æµ‹è¯•è„šæœ¬

è¿™æ˜¯ä¸€ä¸ªåŠŸèƒ½æ€§çš„æµ‹è¯•è„šæœ¬ï¼Œé€‚åˆè‡ªåŠ¨åŒ–æµ‹è¯•ã€‚

```bash
# è¿è¡Œå®Œæ•´æµ‹è¯•
./scripts/test_mcp.sh
```

### 3. ä½¿ç”¨ç®€å•æµ‹è¯•è„šæœ¬

è¿™æ˜¯æœ€å¿«é€Ÿçš„éªŒè¯æ–¹å¼ï¼Œé€‚åˆå¼€å‘æ—¶å¿«é€Ÿæ£€æŸ¥ã€‚

```bash
# è¿è¡Œç®€å•æµ‹è¯•
./scripts/simple_test.sh
```

**è¾“å‡ºç¤ºä¾‹ï¼š**
```
[INFO] å¼€å§‹ç®€å• MCP æµ‹è¯•...
[INFO] æ£€æŸ¥ä¾èµ–...
[SUCCESS] ä¾èµ–æ£€æŸ¥é€šè¿‡
[INFO] æµ‹è¯• MCP åè®®é€šä¿¡...
[SUCCESS] MCP åè®®é€šä¿¡æµ‹è¯•æˆåŠŸ
å“åº”: {"jsonrpc":"2.0","id":"test_001","result":{...}}
[INFO] æµ‹è¯•å·¥å…·è°ƒç”¨...
[SUCCESS] å·¥å…·è°ƒç”¨æµ‹è¯•æˆåŠŸ
å“åº”: {"jsonrpc":"2.0","id":"test_list_001","result":{...}}
[SUCCESS] æ‰€æœ‰æµ‹è¯•å®Œæˆ
```

## æ‰‹åŠ¨æµ‹è¯•

å¦‚æœä½ æƒ³æ‰‹åŠ¨æµ‹è¯•ç‰¹å®šçš„ MCP è¯·æ±‚ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ï¼š

### 1. ç›´æ¥é€šè¿‡ç®¡é“æµ‹è¯•

```bash
# æµ‹è¯•åˆ—è¡¨æŸ¥è¯¢
echo '{"jsonrpc":"2.0","id":"test_001","method":"toolCall","params":{"name":"list","parameters":{"page":1,"limit":5}}}' | ./bin/mcp2rest -config ./configs/bmc_api.yaml
```

### 2. æµ‹è¯• BMC åˆ›å»º

```bash
# æµ‹è¯•åˆ›å»º BMC
echo '{"jsonrpc":"2.0","id":"test_002","method":"toolCall","params":{"name":"create","parameters":{"id":"test_001","title":"æµ‹è¯• BMC","description":"æµ‹è¯•æè¿°"}}}' | ./bin/mcp2rest -config ./configs/bmc_api.yaml
```

### 3. æµ‹è¯• BMC æœç´¢

```bash
# æµ‹è¯•æœç´¢ BMC
echo '{"jsonrpc":"2.0","id":"test_003","method":"toolCall","params":{"name":"search","parameters":{"q":"æµ‹è¯•","page":1,"limit":10}}}' | ./bin/mcp2rest -config ./configs/bmc_api.yaml
```

## æ•…éšœæ’é™¤

### 1. æœåŠ¡å™¨å¯åŠ¨å¤±è´¥

**é”™è¯¯ï¼š** `æœåŠ¡å™¨å¯åŠ¨å¤±è´¥`

**è§£å†³æ–¹æ¡ˆï¼š**
- æ£€æŸ¥å¯æ‰§è¡Œæ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼š`ls -la bin/mcp2rest`
- æ£€æŸ¥é…ç½®æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼š`ls -la configs/bmc_api.yaml`
- æ£€æŸ¥æœåŠ¡å™¨é…ç½®ï¼šç¡®ä¿ `configs/server.yaml` ä¸­çš„ `mode` è®¾ç½®ä¸º `"stdio"`

### 2. MCP åè®®é”™è¯¯

**é”™è¯¯ï¼š** `MCPé”™è¯¯: &{Code:-32601 Message:ä¸æ”¯æŒçš„æ–¹æ³•}`

**è§£å†³æ–¹æ¡ˆï¼š**
- ç¡®ä¿è¯·æ±‚çš„ `method` å­—æ®µä¸º `"toolCall"`
- ç¡®ä¿ `params` åŒ…å« `name` å’Œ `parameters` å­—æ®µ

### 3. å·¥å…·è°ƒç”¨å¤±è´¥

**é”™è¯¯ï¼š** `æŸ¥æ‰¾ç«¯ç‚¹é…ç½®å¤±è´¥`

**è§£å†³æ–¹æ¡ˆï¼š**
- æ£€æŸ¥ OpenAPI è§„èŒƒæ–‡ä»¶æ˜¯å¦æ­£ç¡®è§£æ
- ç¡®ä¿å·¥å…·åç§°ä¸ OpenAPI è§„èŒƒä¸­çš„è·¯å¾„åŒ¹é…
- æ£€æŸ¥å‚æ•°æ ¼å¼æ˜¯å¦æ­£ç¡®

### 4. ç½‘ç»œè¿æ¥é”™è¯¯

**é”™è¯¯ï¼š** `å‘é€HTTPè¯·æ±‚å¤±è´¥`

**è§£å†³æ–¹æ¡ˆï¼š**
- æ£€æŸ¥ç›®æ ‡ API æœåŠ¡å™¨æ˜¯å¦å¯è®¿é—®
- æ£€æŸ¥ç½‘ç»œè¿æ¥
- æ£€æŸ¥ API å¯†é’¥é…ç½®ï¼ˆå¦‚æœéœ€è¦ï¼‰

## æµ‹è¯•ç¯å¢ƒé…ç½®

### 1. è®¾ç½® API å¯†é’¥ï¼ˆå¦‚æœéœ€è¦ï¼‰

å¦‚æœç›®æ ‡ API éœ€è¦è®¤è¯ï¼Œè¯·è®¾ç½®ç¯å¢ƒå˜é‡ï¼š

```bash
export APIKEYAUTH_API_KEY="your_api_key_here"
```

### 2. é…ç½®ä»£ç†ï¼ˆå¦‚æœéœ€è¦ï¼‰

```bash
export HTTP_PROXY="http://proxy.example.com:8080"
export HTTPS_PROXY="http://proxy.example.com:8080"
```

### 3. è°ƒè¯•æ¨¡å¼

å¯ç”¨è¯¦ç»†æ—¥å¿—ï¼š

```bash
export MCP2REST_DEBUG=1
```

## æŒç»­é›†æˆ

å¯ä»¥å°†æµ‹è¯•è„šæœ¬é›†æˆåˆ° CI/CD æµç¨‹ä¸­ï¼š

```yaml
# .github/workflows/test.yml
name: Test MCP2REST
on: [push, pull_request]
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - uses: actions/setup-go@v2
        with:
          go-version: '1.19'
      - run: go build -o bin/mcp2rest cmd/mcp2rest/main.go
      - run: go build -o bin/test_client cmd/test_client/main.go
      - run: ./bin/test_client
```

## æ€§èƒ½æµ‹è¯•

å¯¹äºæ€§èƒ½æµ‹è¯•ï¼Œå¯ä»¥ä¿®æ”¹æµ‹è¯•å®¢æˆ·ç«¯ä»¥æ”¯æŒå¹¶å‘æµ‹è¯•ï¼š

```bash
# è¿è¡Œå¹¶å‘æµ‹è¯•ï¼ˆéœ€è¦ä¿®æ”¹æµ‹è¯•ä»£ç ï¼‰
./bin/test_client -concurrent=10 -requests=100
```

## æ€»ç»“

é€šè¿‡è¿™äº›æµ‹è¯•ç¨‹åºï¼Œä½ å¯ä»¥ï¼š

1. âœ… éªŒè¯ MCP åè®®é€šä¿¡æ˜¯å¦æ­£å¸¸
2. âœ… éªŒè¯ REST API è°ƒç”¨æ˜¯å¦æˆåŠŸ
3. âœ… éªŒè¯é”™è¯¯å¤„ç†æ˜¯å¦æ­£ç¡®
4. âœ… éªŒè¯å“åº”æ ¼å¼æ˜¯å¦ç¬¦åˆé¢„æœŸ
5. âœ… è·å¾—è¯¦ç»†çš„æµ‹è¯•æŠ¥å‘Šå’Œæ€§èƒ½æŒ‡æ ‡

å»ºè®®åœ¨å¼€å‘è¿‡ç¨‹ä¸­ç»å¸¸è¿è¡Œæµ‹è¯•ï¼Œç¡®ä¿åŠŸèƒ½æ­£å¸¸ã€‚
